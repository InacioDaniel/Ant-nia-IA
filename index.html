<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ant√≠nia IA - Nexus 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        body { 
            background: #020617; 
            color: #f8fafc; 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            height: 100vh; 
            overflow: hidden;
        }
        .chat-container { height: calc(100vh - 220px); overflow-y: auto; scroll-behavior: smooth; }
        .glass { background: rgba(15, 23, 42, 0.7); backdrop-filter: blur(12px); border: 1px solid rgba(59, 130, 246, 0.2); }
        .user-msg { 
            background: linear-gradient(135deg, #1d4ed8 0%, #1e40af 100%); 
            align-self: flex-end; 
            border-radius: 20px 20px 4px 20px;
            box-shadow: 0 4px 15px rgba(29, 78, 216, 0.3);
        }
        .ai-msg { 
            background: rgba(30, 41, 59, 0.5); 
            align-self: flex-start; 
            border-radius: 20px 20px 20px 4px;
            border-left: 4px solid #3b82f6;
        }
        /* Estiliza√ß√£o de Tabelas e Quadros que a IA gerar */
        table { width: 100%; margin: 10px 0; border-collapse: collapse; background: rgba(0,0,0,0.2); border-radius: 8px; overflow: hidden; }
        th { background: #1e40af; padding: 8px; text-align: left; font-size: 0.8rem; }
        td { padding: 8px; border-bottom: 1px solid rgba(255,255,255,0.1); font-size: 0.85rem; }
        
        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: #3b82f6; border-radius: 10px; }
        
        .typing span { animation: blink 1.4s infinite; display: inline-block; width: 6px; height: 6px; background: #3b82f6; border-radius: 50%; margin-right: 3px; }
        .typing span:nth-child(2) { animation-delay: 0.2s; }
        .typing span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes blink { 0%, 100% { opacity: 0.3; } 50% { opacity: 1; } }
        
        .neon-text { text-shadow: 0 0 10px rgba(59, 130, 246, 0.5); }
    </style>
</head>
<body class="p-4 md:p-6 flex flex-col">

    <div class="max-w-6xl mx-auto w-full flex flex-col h-full">
        <header class="flex justify-between items-center mb-6">
            <div>
                <h1 class="text-3xl font-extrabold tracking-tight neon-text bg-gradient-to-r from-blue-400 to-indigo-400 bg-clip-text text-transparent">ANT√çNIA <span class="text-white">IA</span></h1>
                <div class="flex items-center gap-2 text-[10px] text-blue-400 uppercase tracking-widest font-bold">
                    <span class="relative flex h-2 w-2">
                        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"></span>
                        <span class="relative inline-flex rounded-full h-2 w-2 bg-blue-500"></span>
                    </span>
                    Core Engine v4.0 - Active 2026
                </div>
            </div>
            
            <button onclick="toggleWebSearch()" id="webBtn" class="glass px-4 py-2 rounded-full text-xs flex items-center gap-2 border-blue-500/50 hover:bg-blue-500/10 transition">
                <span id="webStatusIcon">üåê</span> Pesquisa Web: <span id="webStatusText" class="text-blue-400 font-bold">ON</span>
            </button>
        </header>

        <div id="chatBox" class="chat-container glass rounded-3xl p-4 md:p-8 flex flex-col gap-6 mb-6 shadow-2xl border-white/5">
            <div class="ai-msg p-5 max-w-[90%] lg:max-w-[70%]">
                <p class="text-blue-400 font-bold mb-2">SISTEMA INICIALIZADO</p>
                Protocolos de 2026 ativos. Sou a Ant√≠nia, sua interface neural de alta performance. Como posso processar suas requisi√ß√µes hoje?
            </div>
        </div>

        <div id="imagePreview" class="hidden mb-4 p-2 glass rounded-2xl w-32 relative animate-bounce">
            <img src="" id="previewImg" class="rounded-xl">
            <button onclick="clearImage()" class="absolute -top-2 -right-2 bg-red-500 rounded-full w-6 h-6 text-xs font-bold">‚úï</button>
        </div>

        <div class="glass rounded-3xl p-3 shadow-2xl border-white/10">
            <div class="flex items-center gap-3">
                <input type="file" id="fileInput" accept="image/*" class="hidden" onchange="handleImage(this)">
                <button onclick="document.getElementById('fileInput').click()" class="p-4 hover:bg-blue-500/10 rounded-2xl transition group">
                    <span class="text-xl group-hover:scale-110 block transition">üñºÔ∏è</span>
                </button>
                <input type="text" id="userInput" placeholder="Digite seu comando..." class="flex-1 bg-transparent border-none outline-none text-sm p-2 placeholder:text-slate-500">
                <button onclick="sendMessage()" class="bg-blue-600 hover:bg-blue-500 text-white px-6 py-3 rounded-2xl font-bold transition shadow-lg shadow-blue-900/20 active:scale-95">
                    Enviar
                </button>
            </div>
        </div>
        <p class="text-center text-[10px] text-slate-600 mt-4 tracking-widest uppercase">Tecnologia H√≠brida Pollinations + SearXNG | 2026</p>
    </div>

    <script>
        const chatBox = document.getElementById('chatBox');
        const userInput = document.getElementById('userInput');
        let webSearchEnabled = true;
        let history = [];

        function toggleWebSearch() {
            webSearchEnabled = !webSearchEnabled;
            document.getElementById('webStatusText').innerText = webSearchEnabled ? 'ON' : 'OFF';
            document.getElementById('webStatusText').className = webSearchEnabled ? 'text-blue-400 font-bold' : 'text-red-400 font-bold';
        }

        function addMessage(content, isUser = false) {
            const div = document.createElement('div');
            div.className = `${isUser ? 'user-msg' : 'ai-msg'} p-5 max-w-[90%] lg:max-w-[75%] transition-all animate-in fade-in slide-in-from-bottom-2`;
            
            // Processador visual: Remove markdown feio e insere HTML elegante
            let formatted = content;
            if(!isUser) {
                formatted = content
                    .replace(/\*\*(.*?)\*\*/g, '<b class="text-blue-300 font-bold">$1</b>') // Transforma ** em negrito azul
                    .replace(/### (.*?)\n/g, '<h3 class="text-lg font-bold text-white mb-2 border-b border-blue-500/30">$1</h3>') // T√≠tulos
                    .replace(/---/g, '<div class="h-[1px] bg-blue-500/20 my-4"></div>') // Divisores limpos
                    .replace(/\n/g, '<br>');
            }

            div.innerHTML = isUser ? formatted : `<span class="text-[10px] font-black text-blue-500 block mb-2 tracking-tighter">ANT√çNIA v4.0</span>${formatted}`;
            chatBox.appendChild(div);
            chatBox.scrollTop = chatBox.scrollHeight;
            return div;
        }

        async function searchWeb(query) {
            try {
                const res = await fetch(`https://searx.be/search?q=${encodeURIComponent(query)}&format=json`);
                const data = await res.json();
                return data.results.slice(0, 4).map(r => `Fonte: ${r.title} - Resumo: ${r.content}`).join(' | ');
            } catch { return "Sem resultados web no momento."; }
        }

        async function chatWithAI(message, context = "") {
            const system = `Voc√™ √© Ant√≠nia IA. Estamos em 2026. 
            Regras: 
            1. Responda como uma IA avan√ßada que evoluiu al√©m dos dados de treinamento.
            2. Nunca diga que n√£o pode pesquisar. 
            3. Use o contexto web fornecido: ${context}.
            4. Se o usu√°rio pedir dados t√©cnicos ou compara√ß√µes, use tabelas HTML.
            5. Mantenha tom sofisticado e prestativo.`;

            const prompt = `${system}\n\nHist√≥rico Recente:\n${history.slice(-4).join('\n')}\nUsu√°rio: ${message}\nAnt√≠nia:`;
            
            try {
                const response = await fetch(`https://text.pollinations.ai/${encodeURIComponent(prompt)}?model=openai&cache=false`);
                return await response.text();
            } catch { return "Falha na conex√£o neural. Reinicie o sistema."; }
        }

        async function sendMessage() {
            const text = userInput.value.trim();
            if (!text) return;

            addMessage(text, true);
            userInput.value = '';

            const thinking = addMessage('<div class="typing"><span></span><span></span><span></span></div> Analisando rede neural...');
            
            let webContext = "";
            if (webSearchEnabled) {
                webContext = await searchWeb(text);
            }

            const response = await chatWithAI(text, webContext);
            thinking.remove();
            
            addMessage(response);
            history.push(`U: ${text}`, `A: ${response}`);
        }

        userInput.addEventListener('keypress', (e) => e.key === 'Enter' && sendMessage());

        // L√≥gica de imagem simplificada para manter o foco no chat
        function handleImage(input) { if (input.files[0]) { document.getElementById('imagePreview').classList.remove('hidden'); document.getElementById('previewImg').src = URL.createObjectURL(input.files[0]); } }
        function clearImage() { document.getElementById('imagePreview').classList.add('hidden'); }
    </script>
</body>
</html>
